kind: tools
name: list_replication_slots
type: postgres-sql
source: cloudsql-pg-source
description: List key details for all PostgreSQL replication slots (e.g., type, database, active status) and calculates the size of the outstanding WAL that is being prevented from removal by the slot.
statement: |
  SELECT
  slot_name,
  slot_type,
  plugin,
  database,
  temporary,
  active,
  restart_lsn,
  confirmed_flush_lsn,
  xmin,
  catalog_xmin,
  pg_size_pretty(pg_wal_lsn_diff(pg_current_wal_lsn(), restart_lsn)) AS retained_wal
  FROM pg_replication_slots;
authRequired: []
parameters: []
templateParameters: []
---
kind: sources
name: cloudsql-pg-source
type: cloud-sql-postgres
project: twisha-dev
region: us-central1
instance: sdk-testing
ipType: public
database: inventory
user: postgres
password: TestPassword1@
